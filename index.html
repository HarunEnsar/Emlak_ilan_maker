<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Emlak İlanı Oluşturucu</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: #f5f5f5;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: #e74c3c;
            color: white;
            padding: 20px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .form-section {
            padding: 30px;
        }

        .form-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }

        .type-selector {
            grid-column: 1 / -1;
            margin-bottom: 20px;
        }

        .type-buttons {
            display: flex;
            gap: 10px;
            justify-content: center;
        }

        .type-btn {
            padding: 15px 30px;
            border: 3px solid;
            border-radius: 5px;
            background: white;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }

        .type-btn.satilik {
            border-color: #e74c3c;
            color: #e74c3c;
        }

        .type-btn.satilik.active {
            background: #e74c3c;
            color: white;
        }

        .type-btn.kiralik {
            border-color: #3498db;
            color: #3498db;
        }

        .type-btn.kiralik.active {
            background: #3498db;
            color: white;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group label {
            background: #e74c3c;
            color: white;
            padding: 10px 15px;
            font-weight: bold;
            font-size: 16px;
            border-radius: 5px 5px 0 0;
            margin-bottom: 0;
        }

        .form-group label.kiralik {
            background: #3498db;
        }

        .form-group input {
            padding: 15px;
            border: 3px solid #e74c3c;
            border-top: none;
            border-radius: 0 0 5px 5px;
            font-size: 16px;
            outline: none;
        }

        .form-group input.kiralik {
            border-color: #3498db;
        }

        .form-group input:focus {
            border-color: #c0392b;
        }

        .preview-section {
            margin-top: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
        }

        .preview-card {
            background: white;
            border: 4px solid #e74c3c;
            border-radius: 10px;
            padding: 20px;
            max-width: 800px;
            margin: 0 auto;
            position: relative;
        }

        .preview-card.kiralik {
            border-color: #3498db;
        }

        .preview-header {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 20px;
        }

        .title {
            color: #e74c3c;
            font-size: 3em;
            font-weight: bold;
            letter-spacing: 2px;
            text-align: center;
        }

        .title.kiralik {
            color: #3498db;
        }

        .property-details {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .detail-row {
            display: flex;
            border-radius: 5px;
            overflow: hidden;
            border: 3px solid #e74c3c;
        }

        .detail-row.kiralik {
            border-color: #3498db;
        }

        .detail-label {
            background: #e74c3c;
            color: white;
            padding: 15px 20px;
            font-weight: bold;
            font-size: 18px;
            min-width: 120px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .detail-label.kiralik {
            background: #3498db;
        }

        .detail-value {
            background: white;
            padding: 15px 20px;
            font-size: 18px;
            font-weight: bold;
            color: #333;
            flex: 1;
            display: flex;
            align-items: center;
        }

        .buttons {
            text-align: center;
            margin-top: 30px;
        }

        .btn {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 16px;
            border-radius: 5px;
            cursor: pointer;
            margin: 0 10px;
            transition: background 0.3s;
        }

        .btn:hover {
            background: #c0392b;
        }

        .btn-secondary {
            background: #95a5a6;
        }

        .btn-secondary:hover {
            background: #7f8c8d;
        }

        @media print {
            body { margin: 0; }
            .form-section, .buttons { display: none; }
            .preview-section { margin: 0; padding: 0; background: white; }
            .container { box-shadow: none; }
        }

        @media (max-width: 768px) {
            .form-grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .type-buttons {
                flex-direction: column;
                align-items: center;
            }
            
            .type-btn {
                width: 200px;
                margin-bottom: 10px;
            }
            
            .preview-card {
                margin: 0 10px;
                padding: 15px;
            }
            
            .title {
                font-size: 2em;
            }
            
            .detail-label, .detail-value {
                padding: 12px 15px;
                font-size: 16px;
            }
            
            .btn {
                display: block;
                width: 100%;
                margin: 10px 0;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Emlak İlanı Oluşturucu</h1>
            <p>Bilgileri doldurun ve resim olarak indirin</p>
        </div>

        <div class="form-section">
            <div class="type-selector">
                <div class="type-buttons">
                    <button class="type-btn satilik active" onclick="setType('satilik')">SATILIK</button>
                    <button class="type-btn kiralik" onclick="setType('kiralik')">KİRALIK</button>
                </div>
            </div>
            
            <div class="form-grid">
                <div class="form-group">
                    <label for="cins" id="label-cins">CİNS</label>
                    <input type="text" id="cins" placeholder="Örn: 3+1 DAİRE (115 M²)">
                </div>
                <div class="form-group">
                    <label for="konum" id="label-konum">KONUM</label>
                    <input type="text" id="konum" placeholder="Örn: MEHMET AKİF MAH.">
                </div>
                <div class="form-group">
                    <label for="ozellik" id="label-ozellik">ÖZELLİK</label>
                    <input type="text" id="ozellik" placeholder="Örn: ESKİ YAPI, 2. KAT, 60 M² ARSA PAYI">
                </div>
                <div class="form-group">
                    <label for="fiyat" id="label-fiyat">FİYAT</label>
                    <input type="text" id="fiyat" placeholder="Örn: 2 MİLYON 400 BİN TL">
                </div>
            </div>

            <div class="buttons">
                <button class="btn" onclick="updatePreview()">Önizlemeyi Güncelle</button>
                <button class="btn btn-secondary" onclick="clearForm()">Temizle</button>
                <button class="btn" onclick="downloadAsImage()">Resim İndir</button>
            </div>
        </div>

        <div class="preview-section">
            <h3 style="text-align: center; margin-bottom: 20px; color: #e74c3c;" id="preview-title">Önizleme</h3>
            <div class="preview-card" id="preview-card">
                <div class="preview-header">
                    <div class="title" id="title-text">SATILIK</div>
                </div>
                <div class="property-details">
                    <div class="detail-row" id="detail-row-1">
                        <div class="detail-label" id="detail-label-1">CİNS</div>
                        <div class="detail-value" id="preview-cins">3+1 DAİRE (115 M²)</div>
                    </div>
                    
                    <div class="detail-row" id="detail-row-2">
                        <div class="detail-label" id="detail-label-2">KONUM</div>
                        <div class="detail-value" id="preview-konum">MEHMET AKİF MAH.</div>
                    </div>
                    
                    <div class="detail-row" id="detail-row-3">
                        <div class="detail-label" id="detail-label-3">ÖZELLİK</div>
                        <div class="detail-value" id="preview-ozellik">ESKİ YAPI, 2. KAT, 60 M² ARSA PAYI</div>
                    </div>
                    
                    <div class="detail-row" id="detail-row-4">
                        <div class="detail-label" id="detail-label-4">FİYAT</div>
                        <div class="detail-value" id="preview-fiyat">2 MİLYON 400 BİN TL</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentType = 'satilik';

        function setType(type) {
            currentType = type;
            
            // Update buttons
            document.querySelectorAll('.type-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelector(`.type-btn.${type}`).classList.add('active');
            
            // Update form colors
            const labels = document.querySelectorAll('.form-group label');
            const inputs = document.querySelectorAll('.form-group input');
            
            labels.forEach(label => {
                label.classList.remove('kiralik');
                if (type === 'kiralik') label.classList.add('kiralik');
            });
            
            inputs.forEach(input => {
                input.classList.remove('kiralik');
                if (type === 'kiralik') input.classList.add('kiralik');
            });
            
            // Update preview
            const previewCard = document.getElementById('preview-card');
            const titleText = document.getElementById('title-text');
            const previewTitle = document.getElementById('preview-title');
            const detailLabels = document.querySelectorAll('.detail-label');
            const detailValues = document.querySelectorAll('.detail-value');
            const detailRows = document.querySelectorAll('.detail-row');
            
            if (type === 'kiralik') {
                previewCard.classList.add('kiralik');
                titleText.classList.add('kiralik');
                titleText.textContent = 'KİRALIK';
                previewTitle.style.color = '#3498db';
                detailLabels.forEach(label => label.classList.add('kiralik'));
                detailValues.forEach(value => value.classList.add('kiralik'));
                detailRows.forEach(row => row.classList.add('kiralik'));
            } else {
                previewCard.classList.remove('kiralik');
                titleText.classList.remove('kiralik');
                titleText.textContent = 'SATILIK';
                previewTitle.style.color = '#e74c3c';
                detailLabels.forEach(label => label.classList.remove('kiralik'));
                detailValues.forEach(value => value.classList.remove('kiralik'));
                detailRows.forEach(row => row.classList.remove('kiralik'));
            }
        }

        function updatePreview() {
            const cins = document.getElementById('cins').value || '3+1 DAİRE (115 M²)';
            const konum = document.getElementById('konum').value || 'MEHMET AKİF MAH.';
            const ozellik = document.getElementById('ozellik').value || 'ESKİ YAPI, 2. KAT, 60 M² ARSA PAYI';
            const fiyat = document.getElementById('fiyat').value || '2 MİLYON 400 BİN TL';

            document.getElementById('preview-cins').textContent = cins.toUpperCase();
            document.getElementById('preview-konum').textContent = konum.toUpperCase();
            document.getElementById('preview-ozellik').textContent = ozellik.toUpperCase();
            document.getElementById('preview-fiyat').textContent = fiyat.toUpperCase();
        }

        function clearForm() {
            document.getElementById('cins').value = '';
            document.getElementById('konum').value = '';
            document.getElementById('ozellik').value = '';
            document.getElementById('fiyat').value = '';
            updatePreview();
        }

        function downloadAsImage() {
            updatePreview();
            
            const previewCard = document.getElementById('preview-card');
            
            // Önce preview card'ı sabit boyutta klonla
            const clonedCard = previewCard.cloneNode(true);
            clonedCard.style.position = 'absolute';
            clonedCard.style.left = '-9999px';
            clonedCard.style.top = '0';
            clonedCard.style.width = '600px'; // Sabit genişlik
            clonedCard.style.maxWidth = '600px';
            clonedCard.style.padding = '20px';
            clonedCard.style.fontSize = '16px';
            clonedCard.style.border = currentType === 'kiralik' ? '4px solid #3498db' : '4px solid #e74c3c';
            clonedCard.style.borderRadius = '10px';
            clonedCard.style.background = 'white';
            clonedCard.style.boxSizing = 'border-box';
            
            // Klonu DOM'a ekle
            document.body.appendChild(clonedCard);
            
            // Klonun boyutlarını ayarla
            const titleElement = clonedCard.querySelector('.title');
            if (titleElement) {
                titleElement.style.fontSize = '2.5em';
            }
            
            const detailLabels = clonedCard.querySelectorAll('.detail-label');
            const detailValues = clonedCard.querySelectorAll('.detail-value');
            
            detailLabels.forEach(label => {
                label.style.fontSize = '16px';
                label.style.padding = '12px 16px';
                label.style.minWidth = '100px';
            });
            
            detailValues.forEach(value => {
                value.style.fontSize = '16px';
                value.style.padding = '12px 16px';
            });
            
            // Klon tamamen render edilmesi için kısa bir gecikme
            setTimeout(() => {
                // HTML2Canvas ile klonu yakala
                html2canvas(clonedCard, {
                    backgroundColor: '#ffffff',
                    scale: 2,
                    useCORS: true,
                    allowTaint: true,
                    width: clonedCard.offsetWidth,
                    height: clonedCard.offsetHeight,
                    scrollX: 0,
                    scrollY: 0,
                    logging: false
                }).then(function(canvas) {
                // Klonu DOM'dan kaldır
                document.body.removeChild(clonedCard);
                
                // A4 landscape canvas oluştur (sabit boyutlar)
                const landscapeCanvas = document.createElement('canvas');
                const ctx = landscapeCanvas.getContext('2d');
                
                // A4 landscape boyutları (297x210 mm = 1754x1240 px at 150dpi)
                const A4_WIDTH = 1754;
                const A4_HEIGHT = 1240;
                
                landscapeCanvas.width = A4_WIDTH;
                landscapeCanvas.height = A4_HEIGHT;
                
                // Beyaz arka plan
                ctx.fillStyle = '#ffffff';
                ctx.fillRect(0, 0, A4_WIDTH, A4_HEIGHT);
                
                // İçeriği A4'e sığdır ve ortala
                const margin = 100;
                const maxWidth = A4_WIDTH - (margin * 2);
                const maxHeight = A4_HEIGHT - (margin * 2);
                
                // Scale hesapla
                const scaleX = maxWidth / canvas.width;
                const scaleY = maxHeight / canvas.height;
                const scale = Math.min(scaleX, scaleY);
                
                const scaledWidth = canvas.width * scale;
                const scaledHeight = canvas.height * scale;
                
                // Merkeze yerleştir
                const x = (A4_WIDTH - scaledWidth) / 2;
                const y = (A4_HEIGHT - scaledHeight) / 2;
                
                // İçeriği çiz
                ctx.drawImage(canvas, x, y, scaledWidth, scaledHeight);
                
                // İndir
                const link = document.createElement('a');
                const fileName = currentType === 'kiralik' ? 'kiralik-ilani.png' : 'satilik-ilani.png';
                
                link.download = fileName;
                link.href = landscapeCanvas.toDataURL('image/png', 0.95);
                
                // Link'i DOM'a ekle, tıkla ve kaldır
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                
                }).catch(function(error) {
                    // Hata durumunda klonu temizle
                    if (document.body.contains(clonedCard)) {
                        document.body.removeChild(clonedCard);
                    }
                    console.error('Resim indirme hatası:', error);
                    alert('Resim indirme sırasında bir hata oluştu. Lütfen tekrar deneyin.');
                });
            }, 100); // 100ms gecikme
        }        // Auto-update preview when typing
        document.addEventListener('DOMContentLoaded', function() {
            const inputs = ['cins', 'konum', 'ozellik', 'fiyat'];
            inputs.forEach(id => {
                document.getElementById(id).addEventListener('input', updatePreview);
            });
        });
    </script>
</body>
</html>
